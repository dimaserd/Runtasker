@using Runtasker.LocaleBuilders.Statics
@using Runtasker.LocaleBuilders.Enumerations
@{
    //Как нибудь засунь эти ифы и это все в форич
    Layout = null;
    string rus = "Русский";
    string chinese = "中文(简体)";
    string eng = "English";

    Lang currentLang = LanguageStatic.Language; 
}

<div class="btn-group pull-right hidden-xs">
    <button id="langToogler" class="dropdown-toggle language" type="button">
        @if (currentLang == Lang.Russian)
        {
            <img src="~/assets/images/flags/ru.png" width="16" height="11" alt="RUS Язык" />
            @rus
            <span class="caret"></span>
        }
        else if (currentLang == Lang.Chinese)
        {
            <img src="~/assets/images/flags/cn.png" width="16" height="11" alt="@chinese" />
            @chinese
            <span class="caret"></span>
        }
        else
        {
            <img src="~/assets/images/flags/gb.png" width="16" height="11" alt="EN Language" />
            @eng
            <span class="caret"></span>
        }

    </button>

    <ul class="dropdown-menu">
        @if (currentLang != Lang.English)
        {
            <li>
                <a id="engBtn" language="en" class="languageBtn">
                    <img src="~/assets/images/flags/gb.png" width="16" height="11" alt="EN Language" /> [GB] English
                </a>
            </li>
        }
        
        @if (currentLang != Lang.Russian)
        {
            <li>
                <a id="ruBtn" language="ru-RU" class="languageBtn">
                    <img src="~/assets/images/flags/ru.png" width="16" height="11" alt="RU Language" /> [RUS] Русский
                </a>
            </li>
        }
        
        @if (Runtasker.Settings.Settings.AppSetting == Runtasker.Settings.Enumerations.ApplicationSettingType.Debug && currentLang != Lang.Chinese)
        {
            <li>
                <a id="chineseBtn" language="zh-CN" class="languageBtn">
                    <img src="~/assets/images/flags/cn.png" width="16" height="11" alt="CN Language" /> [CN] 中文(简体)
                </a>
            </li>
        }
    </ul>
</div>

<!--Скрипт раскрывалки-->
<script>
        document.addEventListener('DOMContentLoaded', function () {

            $("#langToogler").click(function () {
                if ($(this).parent().hasClass("open"))
                {
                    $(this).parent().removeClass("open");
                }
                else
                {
                    if ($("#quick_sign_in").parent().hasClass("open"))
                    {
                        $("#quick_sign_in").parent().removeClass("open")
                    }
                    $(this).parent().addClass("open");
                }
            })


        }, false);
</script>
<!--/Скрипт раскрывалки-->

<!--Скрипт посыла на смену языка-->
<script>
    document.addEventListener('DOMContentLoaded', function () {

        var ruBtn = $("#ruBtn");

        var engBtn = $("#engBtn");

        var languageBtns = $(".languageBtn");

        languageBtns.click(function (e) {
            e.preventDefault();
            var langCode = $(this).attr("language");
            var returnUrl = window.location.pathname;
            var link = "/Language/ChangeWithRedirect?LanguageAbbrevation=" + langCode + "&returnUrl=" + returnUrl;
            window.location.href = link;

        })

    })
</script>
<!--/Скрипт посыла на смену языка-->
